
编辑日期：2012年9月10日
原文档在PAD上编辑，这里进一步整理并生成正式功能需求策划。

--------------------------------------------------------------------------------------------------
功能概述：
  消息系统是乐书网核心组建之一，负责消息通知，信息推送，站外消息主动请求，站内关注信息同步等。
  
  消息系统由信息系统和任务系统组成。
  
  其中，信息系统主要记录消息，标明发送者，消息主体，消息类型，消息状态，国企时间，接受者等。信息系统支持token，客队消息内
容进行处理，例如图片，视频，引用，关注等。
  
  任务系统主要负责以消息任务为主题的异步处理，属于系统消息或则job队列范畴。在D7系统中，该任务系统基于system_queue和信息系统实现。
  
  
详细功能描述：
-- 消息分类 --
  说明：消息分类指消息所属类型，根据不同类型的消息，系统调用相应的HOOK处理该类型消息。
  分类：
    【system】 由乐书网系统内部消息，由管理员阅读与处理
    【job】 需要进行处理的任务。
    【following】 关注的消息，该消息包含最新活动信息、活动日志更新等，该消息的获得需要经过用户的操作来实现。
    【push】 推送消息，指用户本身没有关注而发送给用户的信息，这类信息主要以站内邮件为主，其中以“乐书网”名义发送的邮件为系统邮件。
    【thirdpart】 第三方消息，指经过乐书网授权的第三方站点，作为信息发送者的消息。
  子模块：
    【内部邮件】 module:internalmail负责管理用户内部邮件，邮件主要来源包含push,following,system三类信息。用户需要可以在“我的书屋” 查看个人信息，并在
              右上角有信息数量提示。
              后台可对用户邮件进行相应的管理，在开发初期，可只开发后台个人邮件管理框架，待实际需求时，再进一步开发。
    【消息管理：library】 位置：lib/glools/message, 需要支持第三方SNS接口。
    【消息】 module:message lib_glools_message的drupal API，负责执行具体的消息录入、读取、分析和处理等，不做底层工作, 并支持消息推送。
          消息客户端实现的方式是，主动创建消息体，被动接收消息。具体来说就是消息主体负责记录消息到系统中，用户登录或发出消息检索请求时，由消息模块负责提取相应的消息。
    【following】 module:following 关注模块，可对活动、会员等各类信息主体关注。
  其它：
    第三方消息暂时先不支持，需要时再开发。

